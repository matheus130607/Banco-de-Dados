create database joins;

use joins;

-- Tabela Cliente --
create table cliente (
CODCLI CHAR(3) NOT NULL PRIMARY KEY,
NOME VARCHAR(40) NOT NULL,
ENDERECO VARCHAR(50) NOT NULL,
CIDADE VARCHAR(20) NOT NULL,
ESTADO CHAR(2) NOT NULL,
CEP CHAR(9) NOT NULL
);


-- Tabela venda
create table venda (
DUPLIC CHAR(6) NOT NULL PRIMARY KEY,
VALOR DECIMAL (10,2) NOT NULL,
VENCTO DATE NOT NULL,
CODCLI CHAR(3) NOT NULL,
FOREIGN KEY (CODCLI) REFERENCES cliente (CODCLI)
);

-- clientes -- 
insert into cliente values (
'250',
'BANCO BARCA S/A',
'R. VITO, 34',
'SAO SEBASTIAO',
'CE',
'62380-000'
);

insert into cliente values (
'820',
'MECANICA SAO PAULO',
'R. DO MACUCO, 99',
'SANTO ANTONIO',
'ES',
'29810-020'
);

insert into cliente values (
'170',
'POSTO BRASIL LTDA.',
'AV. IMPERIO, 85',
'GUAGIRUS',
'BA',
'42837-000'
);

-- vendas --

insert into venda values (
'230001',
1300.00,
'2001-06-10',
'170'
);

insert into venda values (
'230099',
1000.00,
'2002-10-02',
'820'
);

insert into venda values (
'997818',
3000.00,
'2001-11-11',
'250'
);



-- Tabela nova para uso de inner join 
create table ex (
NOME varchar(100)
);

create table fx (
NOME VARCHAR(100)
);

INSERT INTO ex values 
('Matheus'),
('Bruno'),
('Gabriel'),
('Fernando'),
('Luiz');


INSERT INTO fx values 
('Matheus'),
('Filipo'),
('Jefferson'),
('Gustavo'),
('Vitor');




-- INSERÇÃO DE DADOS NA TABELA CLIENTE

INSERT INTO cliente VALUES (
  '340',
  'TRANSP. CARGA PESADA LTDA.',
  'AV. DOS AUTONOMISTAS, 1000',
  'OSASCO',
  'SP',
  '06020-010'
);

INSERT INTO cliente VALUES (
  '100',
  'MICROS INFORMATICA S/A',
  'R. DAS PALMEIRAS, 4 - LOJA 2',
  'SAO PAULO',
  'SP',
  '01226-010'
);

INSERT INTO cliente VALUES (
  '750',
  'IMOBILIARIA PAVAO',
  'AV. BRASIL, 105',
  'RIO DO PRADO',
  'MG',
  '39940-111'
);

INSERT INTO cliente VALUES (
  '860',
  'ASSIS CONTABIL S/C LTDA.',
  'R. DO MONUMENTO, 550',
  'SANTO AMARO',
  'BA',
  '44200-090'
);

INSERT INTO cliente VALUES (
  '230',
  'SUPERMERCADO BOTAFOGO',
  'R. DA LAGOA, 999',
  'RIO DAS OSTRAS',
  'RJ',
  '28890-540'
);

INSERT INTO cliente VALUES (
  '150',
  'MARCONDES E IRMAO LTDA.',
  'R. DO ORATORIO, 66',
  'ROSARIO OESTE',
  'MT',
  '78470-010'
);

INSERT INTO cliente VALUES (
  '800',
  'DOCEIRA PAO DE ACUCAR',
  'R. MARTINS PENA, 200',
  'SANTO ANDRE',
  'SP',
  '09190-700'
);

INSERT INTO cliente VALUES (
  '990',
  'METALURGICA FOGO E FERRO',
  'R. ARTUR BERNARDES, 3500',
  'SANTO ANDRE',
  'SP',
  '09193-410'
);

INSERT INTO cliente VALUES (
  '500',
  'JOSE DANTAS E FILHOS S/C LTDA.',
  'AV. IPIRANGA, 1000',
  'LUCRECIA',
  'RN',
  '59805-010'
);

INSERT INTO cliente VALUES (
  '300',
  'PCTEC - MICROCOMPUTADORES S/A.',
  'R. CAIS DO PORTO, ARMAZEM 3',
  'SANTOS',
  'SP',
  '11000-005'
);

INSERT INTO cliente VALUES (
  '550',
  'ROTRAM COMERCIAL LTDA.',
  'R. DAS PALMEIRAS, 45 - CJ 10',
  'SAO PAULO',
  'SP',
  '01226-010'
);

-- INSERÇÃO DE DADOS NA TABELA VENDA



INSERT INTO venda VALUES (
  '202550',
  9518.55,
  '2002-11-21',
  '751'
);

INSERT INTO venda VALUES (
  '113340',
  2002.00,
  '2001-11-25',
  '230'
);

INSERT INTO venda VALUES (
  '900450',
  1200.00,
  '2002-09-09',
  '340'
);

INSERT INTO venda VALUES (
  '202020',
  2390.00,
  '2001-11-11',
  '550'
);

INSERT INTO venda VALUES (
  '100200',
  3500.00,
  '2002-11-10',
  '230'
);

INSERT INTO venda VALUES (
  '345611',
  5090.67,
  '2002-12-12',
  '550'
);

INSERT INTO venda VALUES (
  '900855',
  2356.00,
  '2002-10-10',
  '340'
);

INSERT INTO venda VALUES (
  '100000',
  5060.88,
  '1999-05-15',
  '300'
);

INSERT INTO venda VALUES (
  '100335',
  2002.50,
  '2006-01-20',
  '990'
);

INSERT INTO venda VALUES (
  '101010',
  5060.88,
  '2000-03-15',
  '300'
);

INSERT INTO venda VALUES (
  '101210',
  9060.55,
  '2001-10-15',
  '300'
);

INSERT INTO venda VALUES (
  '112099',
  1000.00,
  '2005-06-22',
  '150'
);

INSERT INTO venda VALUES (
  '112299',
  1000.00,
  '2005-10-10',
  '150'
);

INSERT INTO venda VALUES (
  '121213',
  1000.00,
  '2002-02-15',
  '170'
);

INSERT INTO venda VALUES (
  '100334',
  2002.50,
  '2005-12-20',
  '990'
);

INSERT INTO venda VALUES (
  '100336',
  2002.50,
  '2006-02-20',
  '990'
);

INSERT INTO venda VALUES (
  '101110',
  3460.66,
  '2000-04-15',
  '300'
);

INSERT INTO venda VALUES (
  '111999',
  1250.00,
  '2005-04-15',
  '150'
);

INSERT INTO venda VALUES (
  '112199',
  1350.00,
  '2005-08-30',
  '150'
);

INSERT INTO venda VALUES (
  '121212',
  1300.00,
  '2002-01-15',
  '170'
);

INSERT INTO venda VALUES (
  '121214',
  1400.00,
  '2002-03-15',
  '170'
);

INSERT INTO venda VALUES (
  '121515',
  1000.00,
  '2003-10-15',
  '230'
);

INSERT INTO venda VALUES (
  '155099',
  1800.00,
  '2004-11-13',
  '250'
);

INSERT INTO venda VALUES (
  '155299',
  1900.00,
  '2003-11-15',
  '250'
);

INSERT INTO venda VALUES (
  '210001',
  6000.00,
  '1999-12-04',
  '100'
);

INSERT INTO venda VALUES (
  '231015',
  1800.00,
  '2005-10-10',
  '550'
);

INSERT INTO venda VALUES (
  '400400',
  6000.00,
  '2003-06-15',
  '340'
);

INSERT INTO venda VALUES (
  '460460',
  1902.50,
  '2004-02-20',
  '100'
);

INSERT INTO venda VALUES (
  '460660',
  1902.50,
  '2004-04-24',
  '100'
);

INSERT INTO venda VALUES (
  '121616',
  1600.00,
  '2003-11-15',
  '230'
);

INSERT INTO venda VALUES (
  '155199',
  1000.00,
  '2003-10-15',
  '250'
);

INSERT INTO venda VALUES (
  '155999',
  1000.00,
  '2004-10-14',
  '250'
);

INSERT INTO venda VALUES (
  '230002',
  1300.00,
  '2005-10-09',
  '550'
);

INSERT INTO venda VALUES (
  '250013',
  2002.00,
  '2002-10-03',
  '820'
);

INSERT INTO venda VALUES (
  '451300',
  1750.00,
  '1999-05-21',
  '800'
);

INSERT INTO venda VALUES (
  '460560',
  1902.50,
  '2004-03-22',
  '100'
);

INSERT INTO venda VALUES (
  '500005',
  5060.88,
  '1999-05-15',
  '990'
);

INSERT INTO venda VALUES (
  '600099',
  1300.00,
  '2001-10-13',
  '860'
);

INSERT INTO venda VALUES (
  '600299',
  1500.00,
  '2002-05-12',
  '860'
);

INSERT INTO venda VALUES (
  '653099',
  1350.88,
  '2003-09-13',
  '750'
);

INSERT INTO venda VALUES (
  '653999',
  1255.99,
  '2003-09-14',
  '750'
);

INSERT INTO venda VALUES (
  '751299',
  1570.00,
  '2005-05-12',
  '800'
);

INSERT INTO venda VALUES (
  '752252',
  1675.00,
  '2006-12-15',
  '820'
);

INSERT INTO venda VALUES (
  '950888',
  2002.50,
  '2006-10-07',
  '500'
);

INSERT INTO venda VALUES (
  '950890',
  2002.50,
  '2006-10-09',
  '500'
);

INSERT INTO venda VALUES (
  '600199',
  1400.00,
  '2002-11-15',
  '860'
);

INSERT INTO venda VALUES (
  '600999',
  1200.00,
  '2001-09-14',
  '860'
);

INSERT INTO venda VALUES (
  '653199',
  1432.77,
  '2004-08-15',
  '750'
);

INSERT INTO venda VALUES (
  '750299',
  1560.00,
  '2004-03-12',
  '800'
);

INSERT INTO venda VALUES (
  '750300',
  1565.00,
  '2004-05-11',
  '800'
);

INSERT INTO venda VALUES (
  '752253',
  1675.00,
  '2006-11-22',
  '820'
);

INSERT INTO venda VALUES (
  '950889',
  2002.50,
  '2006-10-08',
  '500'
);

INSERT INTO venda VALUES (
  '950891',
  2002.50,
  '2006-10-10',
  '500'
);

INSERT INTO venda VALUES (
  '202055',
  2390.00,
  '2004-11-11',
  '550'
);

INSERT INTO venda VALUES (
  '111812',
  3000.00,
  '2006-09-11',
  '170'
);

INSERT INTO venda VALUES (
  '302056',
  2490.00,
  '2006-10-20',
  '550'
);

INSERT INTO venda VALUES (
  '222550',
  9518.55,
  '2005-11-21',
  '750'
);

INSERT INTO venda VALUES (
  '235100',
  1500.00,
  '2005-06-12',
  '500'
);

INSERT INTO venda VALUES (
  '203052',
  9008.33,
  '2005-08-22',
  '550'
);


INSERT INTO venda VALUES (
  '209967',
  9008.33,
  '2006-10-05',
  '550'
);

-- consultas --
select CLIENTE.NOME, VENDA.DUPLIC
FROM CLIENTE, VENDA
WHERE CLIENTE.CODCLI = VENDA.CODCLI;

-- CONSULTA COM INNER JOIN --
SELECT VENDA.DUPLIC, CLIENTE.NOME, CLIENTE.CIDADE
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
ORDER BY CLIENTE.NOME;

SELECT CLIENTE.NOME, COUNT(*) AS QTDE 
FROM CLIENTE INNER JOIN VENDA 
ON CLIENTE.CODCLI = VENDA.CODCLI
GROUP BY CLIENTE.NOME;

SELECT CLIENTE.NOME, SUM(VALOR) AS VALOR 
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
GROUP BY CLIENTE.NOME;



-- CONSULTA MAX E MIN
SELECT CLIENTE.NOME, VENDA.DUPLIC, MAX(VENDA.VALOR) AS MAIOR_VENDA
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
GROUP BY VENDA.VALOR, VENDA.DUPLIC, CLIENTE.NOME
ORDER BY VENDA.VALOR;

SELECT CLIENTE.NOME, VENDA.DUPLIC, MIN(VENDA.VALOR) AS MENOR_VENDA
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
GROUP BY VENDA.VALOR, VENDA.DUPLIC, CLIENTE.NOME
ORDER BY VENDA.VALOR;

select EX.NOME, FX.NOME
FROM EX INNER JOIN FX
ON EX.NOME = FX.NOME
GROUP BY EX.NOME;

select EX.NOME, FX.NOME
FROM EX AS EX
LEFT JOIN FX AS FX 
ON EX.NOME = FX.NOME

union

select EX.NOME, FX.NOME
FROM EX AS EX
RIGHT JOIN FX AS FX 
ON EX.NOME = FX.NOME;

SELECT CLIENTE.NOME, VENDA.VENCTO
FROM  CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
WHERE YEAR(VENDA.VENCTO) = 2001 or MONTH(VENDA.VENCTO) = 11
ORDER BY VENDA.VENCTO;

-- Atividades --


-- ATIVIDADE 1 --
select CLIENTE.NOME, VENDA.DUPLIC, VENDA.VALOR
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
WHERE CLIENTE.NOME LIKE "%PCTEC%";


-- ATIVIDADE 2 --
SELECT CLIENTE.NOME, VENDA.VENCTO, VENDA.DUPLIC
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
WHERE YEAR(VENDA.VENCTO) = 2004 AND MONTH(VENDA.VENCTO) = 11
ORDER BY VENDA.VENCTO;


-- ATIVIDADE 3 --
SELECT CLIENTE.NOME, VENDA.VENCTO, VENDA.DUPLIC
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
WHERE MONTH(VENDA.DUPLIC) = 10
ORDER BY VENDA.VENCTO;


-- ATIVIDADE 4 --
SELECT CLIENTE.NOME, COUNT(*) AS QTDE, SUM(VALOR) AS TOTAL
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
GROUP BY CLIENTE.NOME;


-- ATIVIDADE 5 --
SELECT CLIENTE.NOME, COUNT(*) AS QTDE, SUM(DUPLIC) AS SOMA_DAS_DUPLICATAS
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
GROUP BY CLIENTE.NOME;



-- Atividade 6 --
SELECT CLIENTE.NOME AS NOME, COUNT(DUPLIC) AS VENCIDOS
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
WHERE VENDA.DUPLIC < ('2003-12-31')
GROUP BY CLIENTE.NOME;


-- ATIVIDADE 7 --
SELECT CLIENTE.NOME AS NOME, VENDA.VALOR * 1.10 AS VALOR_DUPLICATA
FROM CLIENTE INNER JOIN VENDA
ON CLIENTE.CODCLI = VENDA.CODCLI
WHERE VENDA.DUPLIC < ('1999-12-31') 
ORDER BY CLIENTE.NOME;














